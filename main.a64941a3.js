(self.webpackChunkninjarion_land=self.webpackChunkninjarion_land||[]).push([[179],{757:function(t,e,i){t.exports=i(666)},642:function(t,e,i){"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function r(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e,i){return e&&o(t.prototype,e),i&&o(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var c=function(){function t(){s(this,t),a(this,"isActive",!1),a(this,"isPressed",!1)}return h(t,[{key:"getInput",value:function(t){this.isPressed!==t&&(this.isActive=t),this.isPressed=t}}]),t}(),u=function(){function t(){var e=this;s(this,t),a(this,"down",new c),a(this,"left",new c),a(this,"right",new c),a(this,"up",new c),a(this,"shift",new c),a(this,"handleKeyDownUp",(function(t){e.keyDownUp(t)}))}return h(t,[{key:"keyDownUp",value:function(t){var e="keydown"===t.type;switch(t.keyCode){case 37:this.left.getInput(e);break;case 32:this.up.getInput(e);break;case 39:this.right.getInput(e);break;case 40:this.down.getInput(e);break;case 16:this.shift.getInput(e)}}}]),t}(),l=function(){function t(e){s(this,t),this.buffer=document.createElement("canvas").getContext("2d"),this.context=e.getContext("2d")}return h(t,[{key:"clearCanvas",value:function(){this.drawRectangle(0,0,this.buffer.canvas.width,this.buffer.canvas.height,"#060606")}},{key:"drawRectangle",value:function(t,e,i,n,r){this.buffer.fillStyle=r,this.buffer.fillRect(Math.round(t),Math.round(e),i,n)}},{key:"drawCircle",value:function(t,e,i,n){this.buffer.beginPath(),this.buffer.arc(t,e,i,0,2*Math.PI),this.buffer.fillStyle=n,this.buffer.fill(),this.buffer.closePath()}},{key:"drawImage",value:function(t,e,i,n,r){this.buffer.drawImage(r,t,e,i,n)}},{key:"drawCropImage",value:function(t,e,i,n,r,s,o,h,a){this.buffer.drawImage(a,t,e,i,n,r,s,o,h)}},{key:"render",value:function(){this.context.drawImage(this.buffer.canvas,0,0,this.buffer.canvas.width,this.buffer.canvas.height,0,0,this.context.canvas.width,this.context.canvas.height)}},{key:"resize",value:function(t,e,i){e/t>i?(this.context.canvas.width=t,this.context.canvas.height=t*i):(this.context.canvas.width=e/i,this.context.canvas.height=e),this.context.imageSmoothingEnabled=!1}}]),t}(),f=function(){function t(e,i,n){var r=this;s(this,t),a(this,"accumulatedTime",0),a(this,"animationFrameRequest",void 0),a(this,"time",void 0),a(this,"updated",!1),a(this,"handleRun",(function(t){r.run(t)})),this.timeStep=e,this.update=n,this.render=i}return h(t,[{key:"run",value:function(t){for(this.accumulatedTime+=t-this.time,this.time=t,this.accumulatedTime>=3*this.timeStep&&(this.accumulatedTime=this.timeStep);this.accumulatedTime>=this.timeStep;)this.accumulatedTime-=this.timeStep,this.update(t),this.updated=!0;this.updated&&(this.updated=!1,this.render(t)),this.animationFrameRequest=window.requestAnimationFrame(this.handleRun)}},{key:"start",value:function(){this.accumulatedTime=this.timeStep,this.time=window.performance.now(),this.handleRun(this.time)}},{key:"stop",value:function(){window.cancelAnimationFrame(this.animationFrameRequest)}}]),t}();function g(t,e,i,n,r,s,o){try{var h=t[s](o),a=h.value}catch(t){return void i(t)}h.done?e(a):Promise.resolve(a).then(n,r)}function p(t){return function(){var e=this,i=arguments;return new Promise((function(n,r){var s=t.apply(e,i);function o(t){g(s,n,r,o,h,"next",t)}function h(t){g(s,n,r,o,h,"throw",t)}o(void 0)}))}}var y=i(757),d=i.n(y),v=function(){function t(){s(this,t)}var e;return h(t,[{key:"get",value:(e=p(d().mark((function t(e){var i,n;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e);case 2:return i=t.sent,n=i.json(),t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)}))),function(t){return e.apply(this,arguments)})}]),t}(),m=function t(e){var i=e.id,n=e.name,r=e.gravity,o=e.friction,h=e.map,a=e.nextLevelId,c=e.airResistance;s(this,t),this.id=i,this.name=n,this.gravity=r,this.friction=o,this.map=h,this.nextLevelId=a,this.airResistance=c};function w(t,e){return(w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function k(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&w(t,e)}function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function x(t,e){if(e&&("object"===b(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function L(t){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var R=function(){function t(e,i,n,r,o){var h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";s(this,t),a(this,"velocity",{x:0,y:0}),a(this,"currentImageFrame",0),this.width=n,this.height=r,this.position={x:e,y:i},this.image=o,this.type=h}return h(t,[{key:"moveRight",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.velocity.x+=5*t}},{key:"moveLeft",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.velocity.x-=5*t}},{key:"offsetRight",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.velocity.x+=5*t}},{key:"offsetLeft",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.velocity.x-=5*t}},{key:"top",get:function(){return this.position.y}},{key:"right",get:function(){return this.position.x+this.width}},{key:"bottom",get:function(){return this.position.y+this.height}},{key:"left",get:function(){return this.position.x}},{key:"specs",get:function(){return[this.image.width*this.currentImageFrame,0,this.width,this.height,this.position.x,this.position.y,this.width,this.height,this.image.img]}},{key:"handleImageAnimationLoop",value:function(){this.currentImageFrame+1===this.image.frames?this.currentImageFrame=0:this.currentImageFrame+=1}},{key:"update",value:function(){this.handleImageAnimationLoop(),this.position.x+=this.velocity.x,this.position.y+=this.velocity.y}}]),t}();var I=function(t){k(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=L(e);if(i){var r=L(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return x(this,t)});function r(t,e,i,o,h){s(this,r);var a=function(t,e){switch(t){case"middle":default:return e.platform}}(o,h),c=a.height;return n.call(this,t,e,i,c,a)}return r}(R),j=function(){var t=p(d().mark((function t(e){var i;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(i=new Image).src=e,t.next=4,i.decode();case 4:return t.abrupt("return",i);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),A=function(t){var e,i,n=t.widthA;return 0===(i=(e={xA:t.heightA,xB:n,yA:t.heightB}).xA)?0:e.xB/i*e.yA},O=function(){function t(e){s(this,t),a(this,"lifes",3),a(this,"score",0),a(this,"height",128),this.sprites=e,this.image=e.idleRight,this.width=A({widthA:this.image.width,heightA:this.image.height,heightB:this.height})}return h(t,[{key:"init",value:function(){this.lastDirection="right",this.direction="right",this.airResistance=1,this.currentAirResistance=0,this.currentImageFrame=0,this.hasSuperPower=!1,this.velocity={x:0,y:0},this.position={x:0,y:0}}},{key:"specs",get:function(){return[this.image.width*this.currentImageFrame,0,this.image.width,this.image.height,this.position.x,this.position.y,this.width,this.height,this.image.img]}},{key:"top",get:function(){return this.position.y}},{key:"right",get:function(){return this.position.x+this.width}},{key:"bottom",get:function(){return this.position.y+this.height}},{key:"left",get:function(){return this.position.x}},{key:"isLookingLeft",get:function(){return"left"===this.lastDirection}},{key:"isLookingRight",get:function(){return"right"===this.lastDirection}},{key:"isMovingUpwards",get:function(){return this.velocity.y<0}},{key:"isMovingDownwards",get:function(){return this.velocity.y>0}},{key:"isMovingLeft",get:function(){return"left"===this.direction}},{key:"isMovingRight",get:function(){return"right"===this.direction}},{key:"isNotMoving",get:function(){return""===this.direction}},{key:"isAboutToTouchGround",get:function(){return this.velocity.y<.1&&this.velocity.y>-.1}},{key:"isTouchingGround",get:function(){return 0===this.velocity.y}},{key:"isGliding",get:function(){return this.currentAirResistance>0}},{key:"moveRight",value:function(){this.lastDirection="right",this.direction="right",this.velocity.x+=5}},{key:"moveLeft",value:function(){this.lastDirection="left",this.direction="left",this.velocity.x-=5}},{key:"jump",value:function(){this.isTouchingGround?this.velocity.y-=128:this.isGliding?this.currentAirResistance=0:this.currentAirResistance=this.airResistance}},{key:"stop",value:function(){this.direction=""}},{key:"handleImageUpdate",value:function(){this.isTouchingGround?this.isMovingRight?this.image=this.sprites.runRight:this.isMovingLeft?this.image=this.sprites.runLeft:this.isNotMoving&&(this.isLookingLeft?this.image=this.sprites.idleLeft:this.isLookingRight&&(this.image=this.sprites.idleRight)):this.isMovingUpwards?this.isLookingLeft?this.image=this.sprites.jumpLeft:this.isLookingRight&&(this.image=this.sprites.jumpRight):this.isMovingDownwards&&(this.isLookingLeft?this.image=this.isGliding?this.sprites.glideLeft:this.sprites.jumpLeft:this.isLookingRight&&(this.image=this.isGliding?this.sprites.glideRight:this.sprites.jumpRight)),this.width=A({widthA:this.image.width,heightA:this.image.height,heightB:this.height})}},{key:"handleImageAnimationLoop",value:function(){this.currentImageFrame+1===this.image.frames?this.currentImageFrame=0:this.currentImageFrame+=1}},{key:"update",value:function(){this.handleImageUpdate(),this.handleImageAnimationLoop(),this.isAboutToTouchGround&&(this.currentAirResistance=0),this.velocity.y-=this.currentAirResistance,this.position.x+=this.velocity.x,this.position.y+=this.velocity.y}}]),t}();var T=function(t){k(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=L(e);if(i){var r=L(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return x(this,t)});function r(t,e,i){var o;s(this,r);var h=i.shuriken;return(o=n.call(this,t,e,64,64,h)).position={x:t+64-o.width/2,y:e+64-o.height/2},o}return h(r,[{key:"specs",get:function(){return[0,0,this.image.width,this.image.height,this.position.x,this.position.y,this.width,this.height,this.image.img]}}]),r}(R);var E=function(t){k(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=L(e);if(i){var r=L(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return x(this,t)});function r(t,e,i){s(this,r);var o=i.block,h=o.width,a=o.height;return n.call(this,t,e,h,a,o)}return r}(R),S=function(t,e){return!(t.position.x>e.position.x+e.width||t.position.x+t.width<e.position.x||t.position.y>e.position.y+e.height||t.position.y+t.height<e.position.y)},P=function(t,e){if(S(t,e)){var i=t.width/2,n=t.height/2,r=e.width/2,s=e.height/2,o=t.position.x+i,h=t.position.y+n,a=o-(e.position.x+r),c=h-(e.position.y+s),u=i+r,l=n+s,f=a>0?u-a:-u-a,g=c>0?l-c:-l-c;return 0!==f&&0!==g?Math.abs(f)<Math.abs(g)?f>0?"left":"right":g>0?"top":"bottom":"none"}};var M=function(t){k(r,t);var e,i,n=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=L(e);if(i){var r=L(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return x(this,t)});function r(t,e,i){s(this,r);var o=i.signRight,h=o.width,a=o.height;return n.call(this,t,e,h,a,o,"sign")}return r}(R),G=function(){function t(e,i,n){s(this,t),this.sprites=n,this.image=n.monsterBubbleIdleLeft,this.width=64,this.height=64,this.position={x:e,y:i},this.lastDirection="left",this.direction="left",this.airResistance=1,this.currentAirResistance=0,this.currentImageFrame=0,this.velocity={x:0,y:0}}return h(t,[{key:"clone",value:function(){return new t(this.position.x,this.position.y,this.sprites)}},{key:"specs",get:function(){return[this.image.width*this.currentImageFrame,0,this.image.width,this.image.height,this.position.x,this.position.y,this.width,this.height,this.image.img]}},{key:"top",get:function(){return this.position.y}},{key:"right",get:function(){return this.position.x+this.width}},{key:"bottom",get:function(){return this.position.y+this.height}},{key:"left",get:function(){return this.position.x}},{key:"isLookingLeft",get:function(){return"left"===this.lastDirection}},{key:"isLookingRight",get:function(){return"right"===this.lastDirection}},{key:"isMovingUpwards",get:function(){return this.velocity.y<0}},{key:"isMovingDownwards",get:function(){return this.velocity.y>0}},{key:"isMovingLeft",get:function(){return"left"===this.direction}},{key:"isMovingRight",get:function(){return"right"===this.direction}},{key:"isNotMoving",get:function(){return""===this.direction}},{key:"isAboutToTouchGround",get:function(){return this.velocity.y<.1&&this.velocity.y>-.1}},{key:"isTouchingGround",get:function(){return 0===this.velocity.y}},{key:"moveRight",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;this.lastDirection="right",this.direction="right",this.velocity.x+=t}},{key:"moveLeft",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;this.lastDirection="left",this.direction="left",this.velocity.x-=t}},{key:"offsetRight",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;this.velocity.x+=t}},{key:"offsetLeft",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;this.velocity.x-=t}},{key:"jump",value:function(){this.isTouchingGround?this.velocity.y-=128:this.isGliding?this.currentAirResistance=0:this.currentAirResistance=this.airResistance}},{key:"stop",value:function(){this.direction=""}},{key:"handleImageUpdate",value:function(){this.isLookingLeft?this.image=this.sprites.monsterBubbleIdleLeft:this.isLookingRight&&(this.image=this.sprites.monsterBubbleIdleRight)}},{key:"handleImageAnimationLoop",value:function(){this.currentImageFrame+1===this.image.frames?this.currentImageFrame=0:this.currentImageFrame+=1}},{key:"update",value:function(){this.handleImageAnimationLoop(),this.handleImageUpdate(),this.isAboutToTouchGround&&(this.currentAirResistance=0),this.velocity.y-=this.currentAirResistance,this.position.x+=this.velocity.x,this.position.y+=this.velocity.y}}]),t}(),F=function(){function t(e){s(this,t),a(this,"scrollOffset",0),a(this,"width",1024),a(this,"height",768),a(this,"level",null),a(this,"test",!1),this.sprites=e,this.player=new O(e)}return h(t,[{key:"init",value:function(){this.map=this.level.map,this.scrollOffset=0,this.generateMap(),this.player.init(),this.player.airResistance=this.level.airResistance,this.isWinning=!1}},{key:"loseHandler",value:function(){this.player.lifes-=1,this.init()}},{key:"createPlatform",value:function(t,e,i,n){return new I(t,e,i,n,this.sprites)}},{key:"createBlock",value:function(t,e){return new E(t,e,this.sprites)}},{key:"createGenericObject",value:function(t,e,i,n,r){return new R(t,e,i,n,r)}},{key:"createShuriken",value:function(t,e){return new T(t,e,this.sprites)}},{key:"createSignRight",value:function(t,e){return new M(t,e,this.sprites)}},{key:"createMonster",value:function(t,e){return new G(t,e,this.sprites)}},{key:"resetMap",value:function(){this.platforms=[],this.backgrounds=[],this.decorations=[],this.blocks=[],this.shurikens=[],this.monsters=[]}},{key:"generateMap",value:function(){var t=this;this.resetMap(),this.backgrounds=[this.createGenericObject(0,0,this.sprites.background.width,this.sprites.background.height,this.sprites.background),this.createGenericObject(0,this.height-this.sprites.hills.height,this.sprites.hills.width,this.sprites.hills.height,this.sprites.hills),this.createGenericObject(0,this.height-this.sprites.sea.height,this.sprites.sea.width,this.sprites.sea.height,this.sprites.sea)];var e=r(this.map).reverse(),i=[-32];e.forEach((function(n,r){n.forEach((function(n,s){if(0!==r){var o=i[s],h=t.height-128*r,a=128*e[0][s];switch(n){case"_":t.platforms.push(t.createPlatform(o,h,a,"middle"));break;case"#":t.blocks.push(t.createBlock(o,h));break;case"*":t.shurikens.push(t.createShuriken(o,h));break;case">":t.decorations.push(t.createSignRight(o,h));break;case"o":t.monsters.push(t.createMonster(o,h))}}else i[s+1]=128*n+i[s]}))})),this.finishObject=this.decorations.find((function(t){return"sign"===t.type}))}},{key:"moveOffsetHandler",value:function(t){var e=t.dir;"left"===e&&(this.scrollOffset+=1),"right"===e&&(this.scrollOffset-=1),[].concat(r(this.platforms),r(this.blocks),r(this.decorations),r(this.shurikens),r(this.monsters)).forEach((function(t){"left"===e&&t.offsetLeft(),"right"===e&&t.offsetRight()})),this.moveBackgrounds({dir:e})}},{key:"moveBackgrounds",value:function(t){var e=this,i=t.dir;this.backgrounds.forEach((function(t,n){var r=1;0===n&&(r=0),1===n&&(r=1),2===n&&(r=4.5),"left"===i&&t.moveLeft(.2*(r+.5)),"right"===i&&t.moveRight(.2*(r+.5)),t.right<e.width?t.position.x=0:t.left>0&&(t.position.x=e.width-t.width)}))}},{key:"collideToPlatforms",value:function(t){this.platforms.forEach((function(e){t.bottom<=e.top&&t.bottom+t.velocity.y>=e.top&&t.right>=e.left&&t.left<=e.right&&(t.position.y=e.top-t.height,t.velocity.y=0)}))}},{key:"collideToBlocks",value:function(t){this.blocks.forEach((function(e){var i=P(t,e);""!==i&&("left"===i?(t.velocity.x*=-1,t.position.x=e.right+t.velocity.x):"right"===i?(t.velocity.x*=-1,t.position.x=e.left-t.width+t.velocity.x+1):"top"===i?(t.position.y=e.bottom,t.velocity.y=0,console.log("aouts, my head")):"bottom"===i&&(t.velocity.y=0,t.position.y=e.top-t.height+1))}))}},{key:"collideToMonsters",value:function(t){for(var e=this.monsters.length-1;e>=0;e--){var i=this.monsters[e],n=P(t,i);if(""===n)return;"bottom"===n?(t.velocity.y-=96,t.position.y=i.top-t.height+1,this.monsters.splice(e,1),this.player.score+=100):["right","left","top"].includes(n)&&this.loseHandler()}}},{key:"collideToShurikens",value:function(t){for(var e=this.shurikens.length-1;e>=0;e--){var i=this.shurikens[e];S(t,i)&&(this.shurikens.splice(e,1),this.player.score+=100)}}},{key:"collideToWorld",value:function(t){t.left<.333*this.width?this.scrollOffset<0?t.left<0&&(t.position.x=0):(t.position.x=.333*this.width,this.moveOffsetHandler({dir:"right"}),t.velocity.x=0):t.right>.666*this.width&&(t.position.x=.666*this.width-t.width,"right"===this.player.direction&&this.moveOffsetHandler({dir:"left"})),t.top>=this.height&&this.loseHandler()}},{key:"handleCollisions",value:function(){var t=this;this.collideToBlocks(this.player),this.collideToPlatforms(this.player),this.collideToWorld(this.player),this.collideToShurikens(this.player),this.collideToMonsters(this.player),this.monsters.forEach((function(e){t.collideToPlatforms(e)}))}},{key:"updateItems",value:function(){var t=this;[].concat(r(this.platforms),r(this.blocks),r(this.shurikens),r(this.backgrounds),r(this.decorations)).forEach((function(e){e.update(),e.velocity.x*=t.level.friction}))}},{key:"updateMonsters",value:function(){var t=this;this.monsters.forEach((function(e,i){e.update(),e.velocity.y+=t.level.gravity,e.velocity.x*=t.level.friction,e.velocity.y*=t.level.friction;var n=e.lastDirection;"left"===n&&e.left<t.width?e.moveLeft(2):"right"===n&&e.right>0&&e.moveRight(2),t.blocks.forEach((function(t){var i=P(e,t);"left"===i?e.moveRight(2):"right"===i&&e.moveLeft(2)})),e.top>t.height&&t.monsters.splice(i,1)}))}},{key:"updatePlayer",value:function(){this.player.update(),this.player.velocity.y+=this.level.gravity,this.player.velocity.x*=this.level.friction,this.player.velocity.y*=this.level.friction}},{key:"update",value:function(){this.updatePlayer(),this.updateItems(),this.updateMonsters(),this.handleCollisions()}}]),t}(),_=["assets/data/level-1.json","assets/data/level-2.json","assets/data/level-3.json"],B=function(){function t(e){s(this,t),a(this,"http",new v),a(this,"currentLevel",0),a(this,"isLevelLoading",!1),a(this,"isWinning",!1),this.sprites=e,this.world=new F(this.sprites)}var e;return h(t,[{key:"loadLevel",value:(e=p(d().mark((function t(){var e,i=this,n=arguments;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=n.length>0&&void 0!==n[0]?n[0]:1,_[e-1]){t.next=3;break}return t.abrupt("return",this.finishGameHandler());case 3:return t.abrupt("return",this.http.get(_[e-1]).then((function(t){i.currentLevel=e,i.world.level=new m(t),i.init(),i.isLevelLoading=!1})));case 4:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"init",value:function(){this.world.init()}},{key:"reset",value:function(){this.loadLevel(1)}},{key:"finishGameHandler",value:function(){this.reset()}},{key:"loadNextLevel",value:function(){this.loadLevel(this.currentLevel+1)}},{key:"winHandler",value:function(){this.isLevelLoading||(console.log("YOU WON"),this.isLevelLoading=!0,this.loadNextLevel())}},{key:"loseHandler",value:function(){this.world.player.lifes=3,this.world.player.score=0,this.isLevelLoading=!0,this.reset()}},{key:"update",value:function(){this.world.update(),this.world.player.lifes<0&&this.loseHandler(),this.world.player.left>this.world.finishObject.right&&this.winHandler()}}]),t}(),D=function t(e,i){s(this,t),this.img=e,this.frames=i,this.width=e.width/i||1,this.height=e.height},C=function(){function t(){s(this,t)}var e;return h(t,[{key:"loadImages",value:(e=p(d().mark((function t(){var e;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([j("assets/images/character-idle-left.png"),j("assets/images/character-idle-right.png"),j("assets/images/character-run-left.png"),j("assets/images/character-run-right.png"),j("assets/images/character-jump-left.png"),j("assets/images/character-jump-right.png"),j("assets/images/character-glide-left.png"),j("assets/images/character-glide-right.png"),j("assets/images/platform.png"),j("assets/images/background.png"),j("assets/images/hills.png"),j("assets/images/sea.png"),j("assets/images/shuriken.png"),j("assets/images/block.png"),j("assets/images/sign-right.png"),j("assets/images/monster-bubble-idle-left.png"),j("assets/images/monster-bubble-idle-right.png")]);case 2:e=t.sent,this.idleLeft=new D(e[0],10),this.idleRight=new D(e[1],10),this.runLeft=new D(e[2],10),this.runRight=new D(e[3],10),this.jumpLeft=new D(e[4],10),this.jumpRight=new D(e[5],10),this.glideLeft=new D(e[6],10),this.glideRight=new D(e[7],10),this.platform=new D(e[8],1),this.background=new D(e[9],1),this.hills=new D(e[10],1),this.sea=new D(e[11],1),this.shuriken=new D(e[12],8),this.block=new D(e[13],1),this.signRight=new D(e[14],1),this.monsterBubbleIdleLeft=new D(e[15],1),this.monsterBubbleIdleRight=new D(e[16],1);case 20:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})}]),t}(),N=document.querySelector("[data-element=canvas]"),H=document.querySelector("[data-element=lifes-value]"),U=document.querySelector("[data-element=score-value]"),q=document.querySelector("[data-element=level-value]"),W=new C;W.loadImages().then((function(){var t=new l(N),e=new u,i=new B(W),n=new f(33.333333333333336,(function(){var e=i.world;t.clearCanvas();var n=[e.backgrounds,e.decorations,e.platforms,e.blocks,e.shurikens,[e.player],e.monsters],s=n[1],o=n[2],h=n[3],a=n[4],c=n[5],u=n[6];[].concat(r(n[0]),r(s),r(o),r(h),r(a),r(c),r(u)).forEach((function(e){return t.drawCropImage.apply(t,r(e.specs))})),t.render()}),(function(){e.up.isActive?(i.world.player.jump(),e.up.isActive=!1):e.right.isActive?i.world.player.moveRight():e.left.isActive?i.world.player.moveLeft():e.left.isActive||e.right.isActive||i.world.player.stop(),i.update(),q.innerText=i.world.level.name,H.innerText=i.world.player.lifes,U.innerText=i.world.player.score}));function s(t){e.handleKeyDownUp(t)}function o(){t.resize(window.innerWidth,window.innerHeight,i.world.height/i.world.width),t.render()}window.ninja={display:t,controller:e,game:i,engine:n,world:i.world,player:i.world.player},i.loadLevel().then((function(){t.buffer.canvas.height=i.world.height,t.buffer.canvas.width=i.world.width,window.addEventListener("keydown",s),window.addEventListener("keyup",s),window.addEventListener("resize",o),n.start(),o()}))}))},666:function(t){var e=function(t){"use strict";var e,i=Object.prototype,n=i.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},s=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",h=r.toStringTag||"@@toStringTag";function a(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{a({},"")}catch(t){a=function(t,e,i){return t[e]=i}}function c(t,e,i,n){var r=e&&e.prototype instanceof d?e:d,s=Object.create(r.prototype),o=new O(n||[]);return s._invoke=function(t,e,i){var n=l;return function(r,s){if(n===g)throw new Error("Generator is already running");if(n===p){if("throw"===r)throw s;return E()}for(i.method=r,i.arg=s;;){var o=i.delegate;if(o){var h=I(o,i);if(h){if(h===y)continue;return h}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===l)throw n=p,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=g;var a=u(t,e,i);if("normal"===a.type){if(n=i.done?p:f,a.arg===y)continue;return{value:a.arg,done:i.done}}"throw"===a.type&&(n=p,i.method="throw",i.arg=a.arg)}}}(t,i,o),s}function u(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var l="suspendedStart",f="suspendedYield",g="executing",p="completed",y={};function d(){}function v(){}function m(){}var w={};a(w,s,(function(){return this}));var k=Object.getPrototypeOf,b=k&&k(k(T([])));b&&b!==i&&n.call(b,s)&&(w=b);var x=m.prototype=d.prototype=Object.create(w);function L(t){["next","throw","return"].forEach((function(e){a(t,e,(function(t){return this._invoke(e,t)}))}))}function R(t,e){function i(r,s,o,h){var a=u(t[r],t,s);if("throw"!==a.type){var c=a.arg,l=c.value;return l&&"object"==typeof l&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){i("next",t,o,h)}),(function(t){i("throw",t,o,h)})):e.resolve(l).then((function(t){c.value=t,o(c)}),(function(t){return i("throw",t,o,h)}))}h(a.arg)}var r;this._invoke=function(t,n){function s(){return new e((function(e,r){i(t,n,e,r)}))}return r=r?r.then(s,s):s()}}function I(t,i){var n=t.iterator[i.method];if(n===e){if(i.delegate=null,"throw"===i.method){if(t.iterator.return&&(i.method="return",i.arg=e,I(t,i),"throw"===i.method))return y;i.method="throw",i.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var r=u(n,t.iterator,i.arg);if("throw"===r.type)return i.method="throw",i.arg=r.arg,i.delegate=null,y;var s=r.arg;return s?s.done?(i[t.resultName]=s.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,y):s:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,y)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function T(t){if(t){var i=t[s];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function i(){for(;++r<t.length;)if(n.call(t,r))return i.value=t[r],i.done=!1,i;return i.value=e,i.done=!0,i};return o.next=o}}return{next:E}}function E(){return{value:e,done:!0}}return v.prototype=m,a(x,"constructor",m),a(m,"constructor",v),v.displayName=a(m,h,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,a(t,h,"GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},L(R.prototype),a(R.prototype,o,(function(){return this})),t.AsyncIterator=R,t.async=function(e,i,n,r,s){void 0===s&&(s=Promise);var o=new R(c(e,i,n,r),s);return t.isGeneratorFunction(i)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},L(x),a(x,h,"Generator"),a(x,s,(function(){return this})),a(x,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},t.values=T,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(A),!t)for(var i in this)"t"===i.charAt(0)&&n.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function r(n,r){return h.type="throw",h.arg=t,i.next=n,r&&(i.method="next",i.arg=e),!!r}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],h=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var a=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var s=r;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,y):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),A(i),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;A(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,i,n){return this.delegate={iterator:T(t),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}},function(t){"use strict";t(t.s=642)}]);
//# sourceMappingURL=main.a64941a3.js.map